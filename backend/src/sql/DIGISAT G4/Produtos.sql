 SELECT
   ESTOQUE.CODIGO,
   ESTOQUE.BARRAS,
   ESTOQUE.NOME AS DESCRICAO,
   ESTOQUE.UND_V AS UND,
   ESTOQUE.UND_C AS UND_COMPRA,
   ESTOQUE.GRUPO,
   ESTOQUE.QTD,
   --CASE WHEN FATOR = NULL then 1 when FATOR = Null then 1 WHEN FATOR LIKE '/%' then 1 else estoque.fator end as FAT_CONV,
   ESTOQUE.LOCALIZACAO AS PERSONAL4,
   EST_ADICIONAIS.CUSTO_MEDIO,
   ESTOQUE.PRECO_CUSTO,
   ESTOQUE.PRECO_CONS AS PRECO_VENDA,
   SUBSTRING(ESTOQUE.OBS FROM 1 FOR 1000) AS OBSERVACOES,
   SUBSTRING(EST_ADICIONAIS.ST FROM 1 FOR 1) AS OST,
   SUBSTRING(EST_ADICIONAIS.ST FROM 2 FOR 2) AS ST,
   EST_ADICIONAIS.CF,
   EST_ADICIONAIS.PIS_ST AS PIS_CODIGO,
   EST_ADICIONAIS.PIS_BASE AS PIS_BASE_NOR,
   EST_ADICIONAIS.PIS_ALIQ AS PIS_ALIQ_NOR,
   EST_ADICIONAIS.PIS_SUB_BASE AS PIS_BASE_SUB,
   EST_ADICIONAIS.PIS_SUB_ALIQ AS PIS_ALIQ_SUB,
   EST_ADICIONAIS.COFINS_ST AS COFINS_CODIGO,
   EST_ADICIONAIS.COFINS_BASE AS COFINS_BASE_NOR,
   EST_ADICIONAIS.COFINS_ALIQ AS COFINS_ALIQ_NOR,
   EST_ADICIONAIS.COFINS_SUB_BASE AS COFINS_BASE_SUB,
   EST_ADICIONAIS.COFINS_SUB_ALIQ AS COFINS_ALIQ_SUB,
   EST_ADICIONAIS.ULTIMA_COMPRA,
   EST_ADICIONAIS.ULTIMA_VENDA,
   EST_ADICIONAIS.DATA_CADASTRO,
   EST_ADICIONAIS.NCM AS COD_NCM,
   EST_ADICIONAIS.COD_ANP
   FROM ESTOQUE
   LEFT JOIN EST_ADICIONAIS ON ESTOQUE.CODIGO = EST_ADICIONAIS.CODIGO
   ORDER BY ESTOQUE.CODIGO
