SELECT
    cast (FAR105.PRODUTO AS INTEGER) AS CODIGO,
    FAR105.NOME AS DESCRICAO,
    FAR103.NOME AS FORNECEDOR,
    FAR104.NOME AS GRUPO,
    FAR105.QTDE_CAIXA AS FAT_CONV,
    SUM (FAR105.PRECO_VENDA) / (FAR105.qtde_caixa) AS PRECO_VENDA,
    FAR105.PRECO_CUSTO AS PRECO_CUSTO,
    FAR105.EST_DEPOSITO AS QTD,
    FAR105.EST_MINIMO AS QTD_IDEAL,
    CAST (FAR105.ULT_VENDA AS DATE) AS ULTIMA_VENDA,
    CAST (FAR105.ULT_COMPRA AS DATE) AS ULTIMA_COMPRA,
    FAR105.MARGEM_VENDA AS MARGEM_LUCRO,
    FAR105.COD_TRIBUTARIO AS ST,
    FAR105.COD_BARRAS AS BARRAS,
    UNIDADESMEDIDA.SIGLA AS UND,
    FAR105.PESOLIQUIDO AS PESO,
    FAR105.CUSTOMEDIO AS CUSTO_MEDIO,
    FAR105.OBSERVACAO AS OBSERVACOES,
    replace(FAR105.COD_TIP_MERCADORIA,'.','') AS COD_NCM,
    FAR105.CEST AS PERSONAL6
FROM FAR105
LEFT JOIN FAR104 ON FAR104.GRUPO = FAR105.GRUPO
LEFT JOIN UNIDADESMEDIDA ON UNIDADESMEDIDA.UNIDADE = FAR105.UNIDADE
LEFT JOIN FAR103 ON FAR103.FORNECEDOR = FAR105.FORNECEDOR
GROUP BY 1,2,3,4,5,7,8,9,10,11,12,13,14,15,16,17,18,19,20