SELECT
  --TABEST1.CONTROLE AS CODIGO,
  TABEST1.CODIGO AS COD_FABRICANTE,
  TABEST1.PRODUTO AS DESCRICAO,
  TABFOR.EMPRESA AS FORNECEDOR,
  TABEST8.setor AS GRUPO,
  TABEST1.PRECOCUSTO AS PRECO_CUSTO,
  TABEST1.CUSTOMEDIO AS CUSTO_MEDIO,
  TABEST1.PRECOVENDA AS PRECO_VENDA,
  TABEST1.QUANTIDADE AS QTD,
  TABEST1.ESTMINIMO AS QTD_IDEAL,
  TABEST1.UNIDADE AS UND,
  TABEST1.LUCRO AS MARGEM_LUCRO,
  --TABEST1.COMISSAO AS COMISSAO,
  TABEST1.ULTREAJ AS ALTERACAO_PRECO,
  TABEST1.OBS AS OBSERVACOES,
  TABEST1.CODIPI AS COD_NCM,
  --SUBSTRING(TABEST1.CST from 2 for 3) AS ST,
  TABEST1.CST AS ST,
  TABEST1.PESOLIQ AS PESO,
  SUBSTRING (TABEST1.CODIGO from 1 FOR 13) AS BARRAS,
  TABEST1.CEST AS PERSONAL6
FROM TABEST1
--LEFT JOIN tabest8 ON TABEST8.controle = TABEST1.lksetor
--LEFT JOIN TABFOR ON TABFOR.CONTROLE = TABEST1.LKFORNEC

---------------------------------------------------------------------------
SELECT
  TABCLI.CODIGO AS CODIGO,
  TABCLI.NOME AS NOME,
  TABCLI.ENDERECO AS ENDERECO,
  TABCLI.ENDNUMERO AS NUMERO,
  TABCLI.ENDCOMPLEMENTO AS COMPLEMENTO,
  TABCLI.BAIRRO AS BAIRRO,
  TABCLI.CIDADE AS CIDADE,
  TABCLI.ESTADO AS UF,
  TABCLI.CEP AS CEP,
  TABCLI.TELEFONE AS TELEFONE,
  TABCLI.CELULAR AS CELULAR,
  TABCLI.DATA AS DATA_CASDASTRO,
  TABCLI.OBS AS OBSERVACOES,
  TABCLI.EMAIL AS EMAIL,
  TABCLI.CGC AS CNPJ_CNPF,
  TABCLI.LIMITECRED AS LIMITE_CREDITO,
  TABCLI.CONTATO AS CONTATO,
  CASE WHEN TABCLI.INSC = '' THEN TABCLI.IDENTIDADE
  ELSE TABCLI.INSC END AS IE_RG,
  TABCLI.FAX AS FAX,
  TABCLI.PROFISSAO AS PROFISSAO
FROM TABCLI

-------------------------------------------------------------------------

SELECT
  TABFOR.CONTROLE AS CODIGO,
  TABFOR.CODIGO AS FANTASIA,
  TABFOR.EMPRESA AS NOME,
  TABFOR.CONTATO AS CONTATO,
  TABFOR.ENDERECO AS ENDERECO,
  TABFOR.BAIRRO AS BAIRRO,
  TABFOR.CIDADE AS CIDADE,
  TABFOR.ESTADO AS UF,
  TABFOR.CEP AS CEP,
  TABFOR.TELEFONE AS TELEFONE,
  TABFOR.FAX AS FAX,
  TABFOR.CGC AS CNPJ_CNPF,
  TABFOR.INSC AS IE_RG,
  TABFOR.OBS AS OBSERVACOES,
  TABFOR.EMAIL AS EMAIL
FROM TABFOR

---------------------------------------------------------------------------------


select
tabcr1.Controle ||'-'|| tabcr1.PARCELA as historico,
tabcr1.DATA as emissao,
tabcr1.NUMDOC ||'-'|| substring (tabcr1.PARCELA from 1 for 2) as documento,
tabcr1.DEVEDOR as nom_cliente,    
tabcr1.LkCliente as cod_cliente,
min (tabcli.cgc) as cnpj,
tabcr1.Valor as valor_dup,
tabcr1.Vencimento as vencimento,
tabcr1.ORIGEM as especie,    
tabcr1.DIVIDA as valor_rec_credito,
tabcr1.TotalPago as valor_rec,
tabcr1.DataCobra as recebimento,
tabcr1.TipoCobra as tipo_doc,
substring (tabcr1.PARCELA from 1 for 2) as num_parcela,
tabcr1.Obs as observacoes,    
tabcr1.LkConta as num_conta,    
tabcr1.LkBanco as banco,
tabcr1.Juros as valor_jur
from tabcr1
inner join tabcli on tabcli.CODIGO = tabcr1.LkCliente
where tabcli.cgc is not null and tabcli.cgc <> '.   .   -' and tabcli.cgc <> '.   .   /    -'
group by 1,2,3,4,5,7,8,9,10,11,12,13,14,15,16,17,18

--------------------------------------------------------------------------


SELECT SETOR AS DESCRICAO FROM TABEST8

SELECT
  TABEST1.CODINTERNO AS COD_FABRICANTE,
  TABEST1.CODIGO AS CARACTERISTICAS,
  TABEST1.PRODUTO AS DESCRICAO,
 --TABEST8.setor AS GRUPO,
  TABEST1.PRECOCUSTO AS PRECO_CUSTO,
  TABEST1.CUSTOMEDIO AS CUSTO_MEDIO,
  TABEST1.PRECOVENDA AS PRECO_VENDA,
  TABEST1.QUANTIDADE AS QTD,
  TABEST1.ESTMINIMO AS QTD_IDEAL,
  TABEST1.UNIDADE AS UND,
  TABEST1.LUCRO AS MARGEM_LUCRO,
  TABEST1.COMISSAO AS COMISSAO,
  TABEST1.ULTREAJ AS ALTERACAO_PRECO,
  TABEST1.OBS AS OBSERVACOES,
  TABEST1.CODIPI AS COD_NCM,
  SUBSTRING(TABEST1.CST from 2 for 3) AS ST,
  TABEST1.CST AS ST,
  TABEST1.PESOLIQ AS PESO,
  TABEST1.CEAN AS BARRAS
  --TABEST1.CEST AS PERSONAL6
FROM TABEST1
--LEFT JOIN tabest8 ON TABEST8.controle = TABEST1.lksetor

-------------------------------------------------------------------------------

--SELECT TABEST8.SETOR AS DESCRICAO FROM TABEST8
