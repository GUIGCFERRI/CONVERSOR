SELECT 
TE.CONTROLE AS CODIGO,
TE.PRODUTO AS DESCRICAO,
TE.CODBARRAS AS BARRAS,
TE.UNIDADE AS UND,
TE.PRECOCUSTO AS PRECO_CUSTO,
TE.PERCLUCRO AS MARGEM_LUCRO,
TE.PRECOVENDA AS PRECO_VENDA,
TE.OBS AS observacoes,
TE.FORNECEDOR AS FORNECEDOR,
TE.TAMANHO,
TE.peso,
TE.CUSTOMEDIO AS CUSTO_MEDIO,
TE.DATAULTIMACOMPRA AS ULTIMA_COMPRA,
TE.DATAULTIMAVENDA AS ULTIMA_VENDA,
coalesce(CAST (TE.DATAHORACADASTRO AS DATE), current_date) AS DATA_CADASTRO,
TE.QTDEMINIMA AS QTD_IDEAL,
TE.QTDE AS QTD,
CASE TE.ATIVO WHEN 'SIM' THEN 'Ativo' ELSE 'Inativo' END AS situacao, 
TE.NCM AS COD_NCM,
TE.CSOSN AS ST,
TE.CODTRIBUTACAOIPI AS IPI_CODIGO_VENDA,
TE.CODTRIBUTACAOPIS AS PIS_CODIGO,
TE.CODTRIBUTACAOCOFINS AS COFINS_CODIGO,
TE.IPPT, 
--LEFT (TE.APLICACAOPRODUTO, 30) AS personal3,
TE.CODCSTORIGEM AS ost,
TE.REFERENCIA AS COD_FABRICANTE,
TE.PERCCOMISSAO AS comissao,
TE.PERCPIS AS PIS_ALIQ_NOR,
TE.PERCCOFINS AS COFINS_ALIQ_NOR,
LEFT (TE.CAMPO1, 30) AS personal1,
LEFT (TE.CAMPO2, 30) AS personal2,
LEFT (TE.CAMPO3, 30) AS personal4,
--LEFT (TE.CAMPO4, 30) AS personal5,
TE.CODBARRASINTERNO AS personal5,
TE.CODIGOANP AS COD_ANP,
TE.MARCA AS CARACTERISTICAS,
TE.SUBGRUPO AS familia,
LEFT (TE.CFOP,3) AS elo,
TE.CEST AS PERSONAL6,
TE.CODBENEFICIOFISCAL AS CBENEF,
TE.CODIGOANVISA AS ANVISA_CODIGO_DE_PRODUTO,
TPROMOCAO.PRECOVENDA AS PRECO_ATACADO,
TGRUPOESTOQUE.GRUPO AS GRUPO
FROM TESTOQUE AS TE
LEFT JOIN TPROMOCAO ON TPROMOCAO.CODPRODUTO = TE.CONTROLE
LEFT JOIN TGRUPOESTOQUE ON TGRUPOESTOQUE.CONTROLE = TE.CODGRUPO
