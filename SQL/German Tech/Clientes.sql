SELECT
	CF.ID AS CODIGO,
	CF.RAZAOSOCIAL AS NOME,	
	CF.NOMEFANTASIA AS FANTASIA,	
	CF.CPFCNPJ AS CNPJ_CNPF,
	CASE WHEN CF.INSCRICAOESTADUAL = '' OR CF.INSCRICAOESTADUAL IS NULL THEN CF.RG ELSE CF.INSCRICAOESTADUAL END AS IE_RG,
	CF.INSCRICAOMUNICIPAL AS IM,
	CF.INSCRICAOSUFRAMA AS SUFRAMA,	
	CF.ENDERECO,
	CF.NUMERO,
	CONCAT(CF.REFERENCIA,' - ',CF.COMPLEMENTO) AS COMPLEMENTO,	
	CF.BAIRRO,	
	CF.CEP,	
	CF.TELEFONE,	
	CF.CELULAR,
	CF.EMAIL,
	CF.OBSERVACOES,
	COALESCE(CF.DATACADASTRO, CURRENT_DATE) AS CADASTRO,
	CF.DATANASCIMENTO AS NASCIMENTO,
	CF.NOMECONTATO AS CONTATO,
	CF.VALORCREDITO AS LIMITE_CREDITO,
	M.NOME AS CIDADE,
	E.SIGLA AS UF
FROM
	CLIENTEFORNECEDOR CF
LEFT JOIN MUNICIPIO M ON M.ID = CF.MUNICIPIO_ID 
LEFT JOIN ESTADO E ON E.ID = M.ESTADO_ID 
WHERE TIPOCADASTRO = 'C' OR TIPOCADASTRO = 'CF'
