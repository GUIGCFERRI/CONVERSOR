SELECT
  PESSOA.CODIGOPESSOA AS CODIGO,
  CAST (PESSOA.DATAHORACADASTRO AS DATE) AS CADASTRO,
  PESSOA.NOME AS NOME,
  PESSOA.APELIDO AS FANTASIA,
  PESSOA.CPF AS CNPJ_CNPF,
  PESSOA.RG AS IE_RG,
  PESSOA.ENDERECO AS ENDERECO,
  PESSOA.NUMERO AS NUMERO,
  PESSOA.COMPLEMENTO AS COMPLEMENTO,
  PESSOA.BAIRRO AS BAIRRO,
  PESSOA.CEP AS CEP,
  MAX (PCT.CONTATO) AS TELEFONE,
  MAX(PCC.CONTATO) AS CELULAR,
  MAX (PCE.CONTATO) AS EMAIL,
  PESSOA_CIDADE.NOME AS CIDADE,
  PESSOA_CIDADE_UF.SIGLA AS UF,
  PESSOA_ESTADOCIVIL.ESTADOCIVIL AS EST_CIVIL,
  CAST (PESSOA.DATANASCIMENTO AS DATE) AS NASCIMENTO,
  PESSOA.PAI AS PAI,
  PESSOA.MAE AS MAE,
  PESSOA.CONJUGE AS CONJUGE,
  PESSOA.OBS AS OBSERVACOES
FROM PESSOA
LEFT JOIN PESSOA_CIDADE ON PESSOA_CIDADE.CODIGOCIDADE = PESSOA.CODIGOCIDADE
LEFT JOIN PESSOA_CIDADE_UF ON PESSOA_CIDADE_UF.CODIGOUF = PESSOA_CIDADE.CODIGOUF
LEFT JOIN PESSOA_ESTADOCIVIL ON PESSOA_ESTADOCIVIL.CODIGOESTADOCIVIL = PESSOA.CODIGOESTADOCIVIL
---LEFT JOIN PESSOA_CONTATO ON PESSOA_CONTATO.CODIGOPESSOA = PESSOA.CODIGOPESSOA
LEFT JOIN PESSOA_CONTATO PCT ON PESSOA.CODIGOPESSOA = PCT.CODIGOPESSOA AND PCT.CODIGOTIPO = '2'
LEFT JOIN PESSOA_CONTATO PCC ON PESSOA.CODIGOPESSOA = PCC.CODIGOPESSOA AND PCC.CODIGOTIPO = '3'
LEFT JOIN PESSOA_CONTATO PCE ON PESSOA.CODIGOPESSOA = PCE.CODIGOPESSOA AND PCE.CODIGOTIPO = '4'
WHERE PESSOA.CODIGOTIPO <> '3'
GROUP BY 1,2,3,4,5,6,7,8,9,10,11,15,16,17,18,19,20,21,22
