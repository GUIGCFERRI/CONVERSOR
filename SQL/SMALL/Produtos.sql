select
 CODIGO as CODIGO,
 REFERENCIA as barras,
 DESCRICAO,
 MEDIDA as und,
 NOME as grupo,
 FORNECEDOR,
 cast (QTD_ATUAL as integer) as qtd,
 cast (QTD_MINIM as integer) as qtd_ideal,
 CUSTOMEDIO as custo_medio,
 CUSTOCOMPR as preco_custo,
 MARGEMLB as margem_lucro,
 PRECO as preco_venda,
 COMISSAO,
 case when (fatorc is null) then 1 else fatorc end as fat_conv,
 case when CSOSN = '' or CSOSN is null then CST else CSOSN END as ST,
 ST as ELO,
 CFOP AS CF,
 CF as cod_ncm,
 ULT_COMPRA as ultima_compra,
 ULT_VENDA as ultima_venda,
 DAT_INICIO as data_cadastro,
 LIVRE1 AS PERSONAL1,
 LIVRE2 AS PERSONAL2,
 LIVRE3 AS PERSONAL5,
 LIVRE4 AS PERSONAL4,
 OBS AS OBSERVACOES,
 REFERENCIA as cod_fabricante,
 cest as personal6,
 PESO,
 FATORC AS FAT_CONV,
 IPPT,
 IPI AS ALIQ_IPI_VENDA,
 CST_IPI AS IPI_CODIGO_VENDA,
 CST_PIS_COFINS_ENTRADA AS PISE_CODIGO,
 CST_PIS_COFINS_ENTRADA AS COFINSE_CODIGO,
 CST_PIS_COFINS_SAIDA AS PIS_CODIGO,
 CST_PIS_COFINS_SAIDA AS COFINS_CODIGO,
 ALIQ_PIS_ENTRADA AS PISE_ALIQ_NOR,
 ALIQ_COFINS_ENTRADA AS COFINSE_ALIQ_NOR,
 ALIQ_PIS_SAIDA AS PIS_ALIQ_NOR,
 ALIQ_COFINS_SAIDA AS COFINS_ALIQ_NOR
 FROM ESTOQUE
 WHERE DESCRICAO IS NOT NULL AND  DESCRICAO <> ''
--and ativo <> '0'
