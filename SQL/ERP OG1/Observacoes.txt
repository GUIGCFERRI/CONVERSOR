*** REVISAR SCRIPT ANTES DE CONVERTER, NÃO DA PARA SABER NA BASE ATUAL O QUE É CLIENTE OU FORNECEDOR

----CODIGO ANTERIOR---

SELECT
       CADMATERIAL.CODIGOAUXILIAR AS CODIGO
      ,CADMATERIAL.DESCRICAO AS DESCRICAO
      ,MAX (MATERIALCODIGOSBARRA.CODIGOBARRA) AS BARRAS
      ,CADMATERIAL.UNIDADESAIDA AS UND
      ,CADMATERIAL.UNIDADEENTRADA AS UND_COMPRA
      ,CADMATERIAL.PESOLIQUIDO AS PESO
      ,MAX (PVCADMATERIAL.SALDO) AS QTD
      ,CADMATERIAL.CUSTOINFORMADO AS PRECO_CUSTO
      ,TABELAPRECOITEM.PRECOVENDA1 AS PRECO_VENDA
      ,CADMATERIAL.SITUACAOTRIBUTARIA AS ST
      ,CAST (TABELAPRECOITEM.ATUALIZACAO AS DATE) AS ALTERACAO_PRECO
      ,CAST (CADMATERIAL.DATACADASTRO AS DATE) AS DATA_CADASTRO
      ,CADMATERIAL.CODIGONCM AS COD_NCM
      ,CADMATERIAL.CODIGOMATERIAL AS COD_FABRICANTE
      ,CADMATERIAL.CODIGOCEST AS PERSONAL6
  FROM Carvalho1.dbo.CADMATERIAL
LEFT JOIN Carvalho1.dbo.TABELAPRECOITEM ON TABELAPRECOITEM.CODIGOTABELAPRECOITEM = CADMATERIAL.CODIGOMATERIAL
LEFT JOIN Carvalho1.dbo.MATERIALCODIGOSBARRA ON MATERIALCODIGOSBARRA.CODIGOMATERIAL = CADMATERIAL.CODIGOMATERIAL
LEFT JOIN Carvalho1.dbo.MATERIALCALCULAPRECO ON MATERIALCALCULAPRECO.CODIGOMATERIAL = CADMATERIAL.CODIGOMATERIAL
LEFT JOIN Carvalho1.dbo.PVCADMATERIAL ON PVCADMATERIAL.CODIGOMATERIAL = CADMATERIAL.CODIGOMATERIAL
WHERE  CADMATERIAL.CODIGOAUXILIAR <> '00000' AND CADMATERIAL.DESCRICAO <> '' OR CADMATERIAL.DESCRICAO IS NULL
GROUP BY 
       CADMATERIAL.CODIGOAUXILIAR
      ,CADMATERIAL.DESCRICAO
      ,CADMATERIAL.UNIDADESAIDA
      ,CADMATERIAL.UNIDADEENTRADA
      ,CADMATERIAL.PESOLIQUIDO
    --,PVCADMATERIAL.SALDO
      ,CADMATERIAL.CUSTOINFORMADO
      ,TABELAPRECOITEM.PRECOVENDA1
      ,CADMATERIAL.SITUACAOTRIBUTARIA
      ,TABELAPRECOITEM.ATUALIZACAO
      ,CADMATERIAL.DATACADASTRO
      ,CADMATERIAL.CODIGONCM
      ,CADMATERIAL.CODIGOMATERIAL
      ,CADMATERIAL.CODIGOCEST
