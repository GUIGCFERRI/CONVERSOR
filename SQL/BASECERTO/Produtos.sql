SELECT
TESTOQUE.CONTROLE AS CODIGO,
TESTOQUE.PRODUTO AS DESCRICAO,
TESTOQUE.CODBARRAS AS BARRAS,
TESTOQUE.UNIDADE AS UND,
TESTOQUE.PRECOCUSTO AS PRECO_CUSTO,
TESTOQUE.CUSTOMEDIO AS CUSTO_MEDIO,
TESTOQUE.PERCLUCRO AS MARGEM_LUCRO,
TESTOQUE.PRECOVENDA AS PRECO_VENDA,
TPROMOCAO.PRECOVENDA AS PRECO_ATACADO,
TESTOQUE.GRUPO,
TESTOQUE.OBS AS OBSERVACOES,
TESTOQUE.FORNECEDOR,
TESTOQUE.TAMANHO,
TESTOQUE.PESO,
TESTOQUE.CUSTOMEDIO AS CUSTO_MEDIO,
TESTOQUE.DATAULTIMACOMPRA AS ULTIMA_COMPRA,
TESTOQUE.DATAULTIMAVENDA AS ULTIMA_VENDA,
CAST(TESTOQUE.DATAHORACADASTRO AS DATE) AS DATA_CADASTRO, 
TESTOQUE.QTDEMINIMA AS QTD_IDEAL,
TESTOQUE.QTDE AS QTD,
CASE TESTOQUE.ATIVO WHEN 'SIM' THEN 'Ativo' WHEN 'NÃO' THEN 'Inativo' END AS SITUACAO,
TESTOQUE.NCM AS COD_NCM,
TESTOQUE.CODTRIBUTACAOPIS AS PIS_CODIGO,
TESTOQUE.CODTRIBUTACAOCOFINS AS COFINS_CODIGO,
TESTOQUE.CODTRIBUTACAOIPI AS IPI_CODIGO_VENDA,
TESTOQUE.IPPT,
TESTOQUE.CODAPLICACAOPRODUTO AS TIPO_ITEM,
TESTOQUE.DIASVALIDADEPRODUTO AS VALIDADE_DIAS,
TESTOQUE.PERCCOMISSAO AS COMISSAO,
TESTOQUE.PERCPIS AS PIS_ALIQ_NOR,
TESTOQUE.PERCCOFINS AS COFINS_ALIQ_NOR,
TESTOQUE.PERCIPI AS ALIQ_IPI_VENDA,
TESTOQUE.MARCA AS FAMILIA,
TESTOQUE.CODIGOANP AS COD_ANP,
TESTOQUE.CODBARRASINTERNO AS PERSONAL1,
TESTOQUE.CSOSN AS ST,
TESTOQUE.REFERENCIA AS COD_FABRICANTE,
TESTOQUE.CEST AS PERSONAL6,
TCSTORIEM.CODIGOORIGEM AS OST
--TUNIDADEMEDIDA.DESCRICAO AS UND,
FROM TESTOQUE
--LEFT JOIN TUNIDADEMEDIDA ON TESTOQUE.CODUNIDADEMEDIDA=TUNIDADEMEDIDA.CONTROLE
LEFT JOIN TPROMOCAO ON TPROMOCAO.CODPRODUTO = TESTOQUE.CONTROLE
LEFT JOIN TCSTORIEM ON TCSTORIEM.CONTROLE = TESTOQUE.CODCSTORIGEM  
